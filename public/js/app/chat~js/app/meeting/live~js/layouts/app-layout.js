(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{"3HR4":function(t,e,s){"use strict";var o=s("o0o1"),a=s.n(o),i=s("L2JU"),r=s("8BOd");s("i8R7");function n(t,e,s,o,a,i,r){try{var n=t[i](r),c=n.value}catch(t){return void s(t)}n.done?e(c):Promise.resolve(c).then(o,a)}function c(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,o)}return s}function u(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?c(Object(s),!0).forEach((function(e){m(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):c(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function m(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}e.a={components:{},data:function(){return{formData:{},formErrors:{},initialFormData:null,initianLength:0,emptyFormData:null,entity:null,preRequisite:{},isLoading:!0,useUserPreference:!1,dataType:null,configType:""}},computed:u(u({},Object(i.c)("config",{configsWithPreference:"configs",configs:"configsOriginal",vars:"vars"})),{},{formHasErrors:function(){var t=!1;return this.formErrors.objForEach((function(e){t=""!==e||t})),t}}),methods:u(u(u(u(u({},Object(i.b)("config",["GetConfig"])),Object(i.b)("user",["GetUser"])),Object(i.b)("navigation",["Generate"])),Object(i.b)("common",["Custom"])),{},{findActualValue:function(t,e){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"uuid";return e.find((function(e){return e[s]===t}))||null},submit:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(formUtil.isUnchanged(this.initialFormData,this.formData))return this.$toasted.info(this.$t("general.nothing_changed"),this.$toastConfig.info),!1;this.isLoading=!0,this.formData.hasOwnProperty("type")&&(this.formData.type=this.formData.type.snakeCase());var s=!0===e||this.useUserPreference?r.e:"module"===this.configType?r.d:r.c;"function"==typeof this.beforeSubmit&&this.beforeSubmit(),s(this.formData).then((function(s){(!0===e||t.useUserPreference?t.GetUser:t.GetConfig)().then((function(){t.$toasted.success(s.message,t.$toastConfig),t.initialFormData=_.cloneDeep(t.formData),t.isLoading=!1})).catch((function(e){t.isLoading=!1,t.formErrors=formUtil.handleErrors(e)})),"function"==typeof t.afterSubmit&&t.afterSubmit(),"function"==typeof t.afterSubmitSuccess&&t.afterSubmitSuccess()})).catch((function(e){t.isLoading=!1,t.formErrors=formUtil.handleErrors(e),"function"==typeof t.afterSubmit&&t.afterSubmit(),"function"==typeof t.afterSubmitError&&t.afterSubmitError()}))},reset:function(){var t=this;formUtil.confirmAction().then((function(e){e.value&&(t.formData=Object.assign({},t.formData,_.cloneDeep(t.initialFormData)))}))},unsavedCheck:function(t){formUtil.unsavedCheckAlert(this.initialFormData,this.formData,t)},fillPreRequisite:function(t){var e=this;this.preRequisite.objForEach((function(s,o){e.preRequisite[o]=t.hasOwnProperty(o)?t[o]:s})),this.isLoading=!1},fillFormData:function(){var t=this;this.isLoading=!0;var e=this.useUserPreference?this.configsWithPreference:this.configs;this.formData.type&&e[this.formData.type]&&(this.formData=formUtil.assignValues(this.formData,e[this.formData.type])),this.formData.types&&Array.isArray(this.formData.types)&&this.formData.types.forEach((function(s){t.formData=formUtil.assignValues(t.formData,e[s])})),this.formData.override&&this.formData.objForEach((function(s,o){s&&_.isObject(s)?t.formData[o]=formUtil.assignValues(t.formData[o],e[o]):t.formData[o]=e[o]?e[o]:s})),"function"==typeof this.addNewRow&&"function"==typeof this.addNewRowIfNone&&this.addNewRowIfNone(),this.isLoading=!1},getInitialData:function(t){var e,s=this;return(e=a.a.mark((function e(){var o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.isLoading=!0,e.prev=1,e.next=4,r.b(Object.keys(s.preRequisite).join(","));case 4:return o=e.sent,s.fillPreRequisite(o),t&&s.$nextTick((function(){t()})),e.abrupt("return",o);case 10:throw e.prev=10,e.t0=e.catch(1),s.isLoading=!1,s.formErrors=formUtil.handleErrors(e.t0),e.t0;case 15:case"end":return e.stop()}}),e,null,[[1,10]])})),function(){var t=this,s=arguments;return new Promise((function(o,a){var i=e.apply(t,s);function r(t){n(i,o,a,r,c,"next",t)}function c(t){n(i,o,a,r,c,"throw",t)}r(void 0)}))})()}}),mounted:function(){this.fillFormData(),this.initialFormData=_.cloneDeep(this.formData)},beforeDestroy:function(){delete this.formData,delete this.formErrors,delete this.preRequisite},beforeRouteLeave:function(t,e,s){this.unsavedCheck(s)}}},"4eoG":function(t,e,s){"use strict";s("yufk")},"8Cr2":function(t,e,s){(e=t.exports=s("I1BE")(!1)).push([t.i,"@import url(https://fonts.googleapis.com/css?family=Muli:300,400,600,700,800,900);",""]),e.push([t.i,".chatgroup-wrapper{flex-direction:column}.chatgroup-wrapper,.chatgroup-wrapper .chatgroup{display:flex;height:100%;max-height:100%;overflow:hidden}.chatgroup-wrapper .chatgroup{flex-grow:1;justify-content:stretch;align-items:stretch;position:relative;flex-direction:row}.chatgroup-wrapper .chatgroup .chatgroup-form .chatgroup-name{display:flex;flex-direction:row;justify-content:space-between;padding:0 .85rem}.chatgroup-wrapper .chatgroup .chatgroup-form .chatgroup-name h6{line-height:2rem;color:hsla(0,0%,100%,.8);margin-bottom:0;flex-grow:1;display:flex;justify-content:flex-start;align-items:center}.chatgroup-wrapper .chatgroup .chatgroup-form .chatgroup-name input.form-control{background:rgba(0,0,0,.1);border-color:rgba(0,0,0,.05) transparent;border-style:solid;border-width:1px;width:100%;height:100%;color:#fff}.chatgroup-wrapper .chatgroup .chatgroup-form .chatgroup-name input.form-control:hover{background:rgba(0,0,0,.15)}.chatgroup-wrapper .chatgroup .chatgroup-form .chatgroup-name input.form-control:active,.chatgroup-wrapper .chatgroup .chatgroup-form .chatgroup-name input.form-control:focus{background:rgba(0,0,0,.35)}.chatgroup-wrapper .chatgroup .chatgroup-form .chatgroup-name input.form-control::-moz-placeholder{color:#6c7580}.chatgroup-wrapper .chatgroup .chatgroup-form .chatgroup-name input.form-control:-ms-input-placeholder{color:#6c7580}.chatgroup-wrapper .chatgroup .chatgroup-form .chatgroup-name input.form-control::placeholder{color:#6c7580}.chatgroup-wrapper .chatgroup .chatgroup-form .chatgroup-name .chatgroup-actions{display:flex;flex-direction:row;justify-content:flex-end}.chatgroup-wrapper .chatgroup .chatgroup-form .chatgroup-name .chatgroup-actions>button{flex-grow:1;background:transparent;border:none;color:#fff;white-space:nowrap;width:40px;height:40px;border-radius:30px}.chatgroup-wrapper .chatgroup .chatgroup-form .chatgroup-name .chatgroup-actions>button:hover{background:rgba(0,0,0,.2);padding-bottom:2px}.chatgroup-wrapper .chatgroup .chatgroup-form .chatgroup-members-header{border-bottom:1px solid rgba(0,0,0,.4)}.chatgroup-wrapper .chatgroup-footer{box-shadow:0 -2px 6px 0 rgba(0,0,0,.4);z-index:1;display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:center}.chatgroup-wrapper .chatgroup-footer button{flex:1 0 auto;margin:0}",""])},A6gD:function(t,e,s){"use strict";var o=s("L2JU"),a=s("OjY7"),i=s("Zp8j"),r=s.n(i),n={props:{activeContainer:{type:String,default:"home",required:!0},configs:{type:Object,required:!0},fullPage:{type:Boolean,default:!1}},computed:{computedTitle:function(){return"settings"===this.activeContainer?$t("config.chat.chat_config"):"chatgroup"===this.activeContainer?$t("chat.chat_group"):$t("chat.live_chat")}}},c=s("KHd+"),u=Object(c.a)(n,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"chat-box-header"},[s("h6",{staticClass:"cb-header-title"},[t._v(t._s(t.computedTitle))]),t._v(" "),s("div",{staticClass:"cb-header-buttons action-buttons"},["chatgroup"===t.activeContainer?[s("button",{attrs:{type:"button"},on:{click:function(e){return t.$emit("goBack")}}},[s("i",{class:["fas",{"fa-chevron-left":"chatgroup"===t.activeContainer}]})]),t._v(" "),s("button",{staticClass:"auto-width",attrs:{type:"button"},on:{click:function(e){return t.$emit("showAddMemberScreen")}}},[s("i",{staticClass:"fas fa-plus"}),t._v(" "),s("span",{staticClass:"px-2"},[t._v(t._s(t.$t("chat.add")))])])]:["home"!==t.activeContainer?s("button",{attrs:{type:"button"},on:{click:function(e){return t.$emit("goHome")}}},[s("i",{class:["fas",{"fa-chevron-left":"conversation"===t.activeContainer},{"fa-chevron-right":"settings"===t.activeContainer}]})]):t._e(),t._v(" "),"settings"!==t.activeContainer?[s("button",{attrs:{type:"button"},on:{click:function(e){return t.$emit("toggleSearch")}}},[s("i",{staticClass:"fas fa-search"})]),t._v(" "),s("button",{attrs:{type:"button"},on:{click:function(e){return t.$emit("goToSettings")}}},[s("i",{staticClass:"fas fa-cog"})])]:t._e(),t._v(" "),"home"===t.activeContainer&&!t.fullPage&&t.configs.chat.seaparateWindow?s("router-link",{staticClass:"button",attrs:{to:{name:"appChat"}}},[s("i",{staticClass:"fas fa-external-link-alt"})]):t._e()],t._v(" "),t.fullPage?t._e():s("button",{attrs:{type:"button"},on:{click:function(e){return t.$emit("hideChatBox")}}},[s("i",{staticClass:"fas fa-times"})])],2)])}),[],!1,null,null,null).exports,m={extends:s("3HR4").a,props:{activeContainer:{type:String,default:"home",required:!0}},watch:{activeContainer:function(t,e){"settings"===t&&t!==e&&(this.formData=Object.assign({},this.formData,_.cloneDeep(this.initialFormData)))}},data:function(){return{now:moment(),formData:{chat:{enableAutoOpen:!1,enterToSubmit:!1,muteSoundNotification:!1},override:!0},useUserPreference:!0}},methods:{afterSubmitSuccess:function(){this.$emit("goHome")}}},h=(s("4eoG"),Object(c.a)(m,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"cb-inner-window settings-container"},["settings"===t.activeContainer?s("div",{staticClass:"settings-wrapper"},[s("div",{staticClass:"settings"},[s("vue-scroll",{ref:"vue-scroll-settings",attrs:{id:"vue-scroll-settings"}},[s("div",{staticClass:"settings-list"},[s("switch-wrapper",{staticClass:"text-light",attrs:{label:t.$t("config.chat.enable_auto_open")}},[s("base-switch",{attrs:{design:"success"},model:{value:t.formData.chat.enableAutoOpen,callback:function(e){t.$set(t.formData.chat,"enableAutoOpen",e)},expression:"formData.chat.enableAutoOpen"}})],1),t._v(" "),s("switch-wrapper",{staticClass:"text-light",attrs:{label:t.$t("config.chat.enter_to_submit")}},[s("base-switch",{attrs:{design:"success"},model:{value:t.formData.chat.enterToSubmit,callback:function(e){t.$set(t.formData.chat,"enterToSubmit",e)},expression:"formData.chat.enterToSubmit"}})],1),t._v(" "),s("switch-wrapper",{staticClass:"text-light",attrs:{label:t.$t("config.chat.mute_sound_notification")}},[s("base-switch",{attrs:{design:"success"},model:{value:t.formData.chat.muteSoundNotification,callback:function(e){t.$set(t.formData.chat,"muteSoundNotification",e)},expression:"formData.chat.muteSoundNotification"}})],1)],1)])],1),t._v(" "),s("div",{staticClass:"settings-footer"},[s("base-button",{attrs:{type:"button",design:"primary",size:"block"},on:{click:t.submit}},[t._v(t._s(t.$t("general.save")))])],1)]):t._e()])}),[],!1,null,null,null).exports);function l(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,o)}return s}function d(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?l(Object(s),!0).forEach((function(e){f(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):l(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function f(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var p={props:{activeContainer:{type:String,default:"home",required:!0},activeGroup:{type:[Object,null],default:function(){return null}},membersToAdd:{type:Array,default:function(){return[]}},membersToRemove:{type:Array,default:function(){return[]}}},data:function(){return{formData:{uuid:null,name:"",isPublicGroup:!1,members:[]},showEditNameForm:!1,isLoading:!1}},watch:{activeContainer:function(t,e){"chatgroup"===t&&t!==e&&(this.activeGroup||(this.formData.uuid=null,this.formData.name="",this.formData.isPublicGroup=!1,this.formData.members=[]))},activeGroup:function(t,e){e!==t&&(t?(this.formData.uuid=t.uuid,this.formData.name=t.name,this.formData.members=t.members,this.getMembers()):(this.formData.uuid=null,this.formData.name="",this.formData.isPublicGroup=!1,this.formData.members=[]))},membersToAdd:{handler:function(t){var e=this;t&&t.length&&t.forEach((function(t){-1===e.formData.members.findIndex((function(e){return e.user.uuid===t.user.uuid}))&&e.formData.members.push(d({},t))}))},deep:!0},membersToRemove:{handler:function(t){var e=this;t&&t.length&&t.forEach((function(t){var s=e.formData.members.findIndex((function(e){return e.user.uuid===t.user.uuid}));-1!==s&&e.formData.members.splice(s,1)}))},deep:!0}},computed:d({},Object(o.c)("user",["hasRole"])),methods:d(d({},Object(o.b)("chat",["CreateRoom","UpdateRoom","GetRoomMembers"])),{},{goBack:function(){this.formData.uuid=null,this.formData.name="",this.formData.isPublicGroup=!1,this.formData.members=[],this.$emit("goBack")},editName:function(){this.showEditNameForm=!0},updateName:function(){var t=this;this.isLoading=!0,this.UpdateRoom({uuid:this.formData.uuid,name:this.formData.name}).then((function(e){t.isLoading=!1,t.showEditNameForm=!1})).catch((function(e){t.isLoading=!1,formUtil.handleErrors(e)}))},createGroup:function(){var t=this;this.isLoading=!0,this.CreateRoom({name:this.formData.name,isPublicGroup:this.formData.isPublicGroup,members:this.formData.members.map((function(t){return t.user}))}).then((function(e){t.isLoading=!1,t.$emit("goToConversation",{room:e,user:null})})).catch((function(e){t.isLoading=!1,formUtil.handleErrors(e)}))},getMembers:function(){var t=this;this.activeGroup&&(this.isLoading=!0,this.GetRoomMembers({uuid:this.activeGroup.uuid}).then((function(e){t.isLoading=!1,t.formData.members=e})).catch((function(e){t.isLoading=!1,formUtil.handleErrors(e)})))}}),mounted:function(){this.activeGroup&&this.getMembers()}},g=(s("aWil"),Object(c.a)(p,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"cb-inner-window chatgroup-container"},["chatgroup"===t.activeContainer?s("div",{staticClass:"chatgroup-wrapper"},[s("div",{staticClass:"chatgroup"},[s("vue-scroll",{ref:"vue-scroll-chatgroup",attrs:{id:"vue-scroll-chatgroup"}},[s("div",{staticClass:"chatgroup-form"},[t.activeGroup?[t.showEditNameForm?t.activeGroup.canModerate?s("div",{staticClass:"chatgroup-name mt-2"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.name,expression:"formData.name"}],ref:"groupName",staticClass:"form-control",attrs:{type:"text",placeholder:t.$t("chat.chat_group_name")},domProps:{value:t.formData.name},on:{input:function(e){e.target.composing||t.$set(t.formData,"name",e.target.value)}}}),t._v(" "),s("div",{staticClass:"chatgroup-actions"},[s("button",{attrs:{type:"button"},on:{click:t.updateName}},[s("i",{staticClass:"fas fa-check"})])])]):t._e():s("div",{staticClass:"chatgroup-name mt-2"},[s("h6",[t._v(t._s(t.formData.name))]),t._v(" "),t.activeGroup.canModerate?s("div",{staticClass:"chatgroup-actions"},[s("button",{attrs:{type:"button"},on:{click:t.editName}},[s("i",{staticClass:"fas fa-pencil-alt"})])]):t._e()])]:[s("div",{staticClass:"chatgroup-name"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.name,expression:"formData.name"}],ref:"groupName",staticClass:"form-control",attrs:{type:"text",placeholder:t.$t("chat.chat_group_name")},domProps:{value:t.formData.name},on:{input:function(e){e.target.composing||t.$set(t.formData,"name",e.target.value)}}})]),t._v(" "),t.hasRole("admin")?s("base-checkbox",{staticClass:"ml-3 mt-4",model:{value:t.formData.isPublicGroup,callback:function(e){t.$set(t.formData,"isPublicGroup",e)},expression:"formData.isPublicGroup"}},[s("span",{staticClass:"text-light"},[t._v(t._s(t.$t("chat.is_public_group"))+"?")])]):t._e()],t._v(" "),s("div",{staticClass:"chatgroup-members-header pt-3"}),t._v(" "),s("div",{staticClass:"chatgroup-members"},[t._t("members",null,{members:t.formData.members})],2)],2)])],1),t._v(" "),t.activeGroup?t._e():s("div",{staticClass:"chatgroup-footer"},[s("base-button",{attrs:{type:"button",design:"dark-primary"},on:{click:t.goBack}},[t._v(t._s(t.$t("general.cancel")))]),t._v(" "),s("base-button",{attrs:{type:"button",design:"primary"},on:{click:t.createGroup}},[t._v(t._s(t.$t("general.save")))])],1)]):t._e()])}),[],!1,null,null,null).exports);function v(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,o)}return s}function b(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?v(Object(s),!0).forEach((function(e){C(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):v(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function C(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var w={props:{room:{type:Object,required:!0},roomName:{type:String,required:!0},showLastMessage:{type:Boolean,default:!0},clickAction:{type:String,default:"goToConversation"},showCustomAction:{type:Boolean,default:!1},clickActionOnCustom:{type:String,default:"removeMember"},customActionIcon:{type:String,default:"fas fa-times"},vars:{type:Object,default:function(){return{}}}},computed:b(b({},Object(o.c)("user",{userUuid:"uuid"})),{},{computedAvatar:function(){return this.room.isGroup||!this.room.member?this.room:this.room.member}}),methods:{onClickRoomItem:function(){this.computedAvatar.uuid!==this.userUuid&&("addToGroup"===this.clickAction?this.$emit(this.clickAction,{room:null,user:this.room.member?this.room.member:this.room}):this.room.isGroup||this.room.member?this.$emit(this.clickAction,{room:this.room,user:null}):this.$emit(this.clickAction,{room:null,user:this.room}))},doCustomAction:function(){this.$emit(this.clickActionOnCustom,{room:this.room,user:this.room.member?this.room.member:this.room})}}},y=Object(c.a)(w,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("li",{class:["room-item"],on:{click:t.onClickRoomItem}},[s("div",{staticClass:"item-thumb"},[s("user-avatar",{attrs:{user:t.computedAvatar,size:40}})],1),t._v(" "),s("div",{staticClass:"item-details"},[s("div",{staticClass:"title-row"},[s("h6",{staticClass:"item-title"},[t._v(t._s(t.roomName))]),t._v(" "),t.showLastMessage&&t.room.lastConversationAt?s("small",{staticClass:"item-meta"},[t._v(t._s(t._f("momentCalendarTz")(t.room.lastConversationAt)))]):t._e()]),t._v(" "),t.showLastMessage&&t.room.lastConversationAt?[t.room.message?s("div",{staticClass:"meta-row text-ellipsis"},["%%chat_attachment_%%"===t.room.message?s("span",[t._v(t._s(t.$t("upload.attachment")))]):s("span",{domProps:{innerHTML:t._s(t.room.message)}})]):t.room.isGroup?s("div",{staticClass:"meta-row text-ellipsis"},[s("span",[t._v(t._s(t.room.memberCount)+" "+t._s(t.$t("chat.members")))])]):t._e()]:t._e(),t._v(" "),t.room.unreadMessages?s("div",{staticClass:"unread-messages"},[s("span",{staticClass:"badge badge-sm badge-pill badge-light"},[t._v(t._s(t.room.unreadMessages))])]):t._e()],2),t._v(" "),t._t("actions",[t.showCustomAction?s("div",{staticClass:"item-actions action-buttons floating-action-buttons"},[s("button",{attrs:{type:"button"},on:{click:function(e){return e.stopPropagation(),t.doCustomAction(e)}}},[s("i",{class:t.customActionIcon})])]):t._e()])],2)}),[],!1,null,null,null).exports;function T(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,o)}return s}function O(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?T(Object(s),!0).forEach((function(e){S(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):T(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function S(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var R={props:{room:{type:Object,required:!0},roomName:{type:String,required:!0},vars:{type:Object,required:!0},configs:{type:Object,required:!0},typingUser:{type:String}},computed:O(O({},Object(o.c)("user",["liveUsers"])),{},{computedUser:function(){return this.room.isGroup||!this.room.member?this.room:this.room.member},roomMembers:function(){return this.room.memberCount<=1?this.$t("chat.only_you_are_member"):this.room.members&&this.room.members.length>1?this.room.members[1].user.profile.name+this.$t("chat.and_n_other_members",{attribute:this.room.memberCount-1}):""}}),methods:{isLiveOnline:function(t){return!(!t||!this.liveUsers.find((function(e){return e.uuid===t.uuid})))},goToGroup:function(){this.$emit("goToGroup",this.room)}}},M=Object(c.a)(R,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"conversation-header"},[s("div",{staticClass:"room-thumb"},[s("user-avatar",{attrs:{user:t.computedUser,size:40}})],1),t._v(" "),s("div",{staticClass:"room-details"},[s("div",{staticClass:"title-row"},[s("h6",{staticClass:"room-title"},[t._v(t._s(t.roomName))])]),t._v(" "),s("div",{staticClass:"meta-row"},[t.room.isGroup||t.typingUser?t.room.isGroup?[t.typingUser?[s("span",{staticClass:"typing-indicator"},[t._v(t._s(t.typingUser)+" "+t._s(t.$t("general.is_typing")))]),t._v(" "),s("span",[t._v("  ")])]:t.roomMembers?s("span",[t._v(t._s(t.roomMembers))]):s("span",[t._v(t._s(t.room.memberCount)+" "+t._s(t.$t("chat.members")))])]:[s("span",{directives:[{name:"show",rawName:"v-show",value:t.typingUser,expression:"typingUser"}],staticClass:"typing-indicator"},[t._v(t._s(t.$t("general.is_typing")))]),t._v(" "),s("span",[t._v("  ")])]:[t.isLiveOnline(t.computedUser)?s("span",[t._v(t._s(t.$t("general.online")))]):s("span",[t._v(t._s(t.$t("general.offline")))])]],2)]),t._v(" "),s("div",{staticClass:"room-btns action-buttons"},[t.room.isGroup&&!t.room.hasLeft&&t.configs.chat.groupChat?s("button",{attrs:{type:"button"},on:{click:t.goToGroup}},[s("i",{staticClass:"fas fa-info-circle"})]):t._e()])])}),[],!1,null,null,null).exports,x={props:{message:{type:Object,required:!0},fileIcons:{type:Object,required:!0},fileMimeTypes:{type:Object,required:!0},vars:{type:Object,default:function(){return{}}}},data:function(){return{messageStatusIcons:{sending:"far fa-clock",sent:"fas fa-check",delivered:"fas fa-check-double",read:"fas fa-check-double",error:"fas fa-exclamation-triangle"}}},computed:{hasAttachment:function(){return(!this.message.message||"%%chat_attachment_%%"===this.message.message)&&this.message.attachments&&this.message.attachments.length}}},j=Object(c.a)(x,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"message-item-wrapper"},[s("div",{class:["message-item",{"has-attachments":t.hasAttachment}]},[s("span",{staticClass:"tail-in"},[s("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 8 13",width:"8",height:"13"}},[s("path",{attrs:{opacity:".13",fill:"#0000000",d:"M1.533 3.568L8 12.193V1H2.812C1.042 1 .474 2.156 1.533 3.568z"}}),s("path",{attrs:{fill:"currentColor",d:"M1.533 2.568L8 11.193V0H2.812C1.042 0 .474 1.156 1.533 2.568z"}})])]),t._v(" "),s("div",{staticClass:"message-header"},[s("h6",{staticClass:"message-user"},[t._v(t._s(t.message.user.profile.name))])]),t._v(" "),t.hasAttachment?s("div",{staticClass:"message-content"},[t._l(t.message.attachments,(function(e){return[s("div",{key:e.uuid,class:["attachment",{"non-image-attachment":"image/png"!==e.mime&&"image/jpeg"!==e.mime}]},["image/png"===e.mime||"image/jpeg"===e.mime?[s("a",{staticClass:"attachment-link",attrs:{href:e.fullUrl,target:"_blank"}},[s("img",{staticClass:"img-fluid",attrs:{src:e.fullUrl,alt:e.filename}})]),t._v(" "),s("div",{staticClass:"attachment-shadow"}),t._v(" "),s("div",{staticClass:"message-footer small"},[t.message.sentAt?s("span",{staticClass:"message-created-at"},[t._v(t._s(t._f("momentCalendarTz")(t.message.sentAt)))]):t._e(),t._v(" "),s("span",{class:["message-status",t.message.status]},[s("i",{class:t.messageStatusIcons[t.message.status]})])])]:[s("a",{staticClass:"attachment-link",attrs:{href:e.fullUrl,target:"_blank"}},[s("div",{staticClass:"attachment-details"},[s("div",{staticClass:"attachment-icon"},[s("i",{class:["fas",t.fileIcons[e.mime]]})]),t._v(" "),s("div",{staticClass:"attachment-name"},[s("h6",[t._v(t._s(e.filename))])]),t._v(" "),t._m(0,!0)])]),t._v(" "),s("div",{staticClass:"message-footer small"},[s("div",{staticClass:"left-side"},[s("span",{staticClass:"attachment-type"},[t._v(t._s(t.fileMimeTypes[e.mime]))]),s("span",{staticClass:"attachment-size"},[t._v(t._s(e.humanReadableSize))])]),t._v(" "),s("div",{staticClass:"right-side"},[t.message.sentAt?s("span",{staticClass:"message-created-at"},[t._v(t._s(t._f("momentCalendarTz")(t.message.sentAt)))]):t._e(),t._v(" "),s("span",{class:["message-status",t.message.status]},[s("i",{class:t.messageStatusIcons[t.message.status]})])])])]],2)]}))],2):s("div",{staticClass:"message-content"},[s("div",{staticClass:"message-body"},[s("div",{staticClass:"message",domProps:{innerHTML:t._s(t.message.message)}}),t._v(" "),s("div",{staticClass:"footer-space"})]),t._v(" "),s("div",{staticClass:"message-footer small"},[t.message.sentAt?s("span",{staticClass:"message-created-at"},[t._v(t._s(t._f("momentCalendarTz")(t.message.sentAt)))]):t._e(),t._v(" "),s("span",{class:["message-status",t.message.status]},[s("i",{class:t.messageStatusIcons[t.message.status]})])])])])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"download-icon"},[e("i",{staticClass:"far fa-arrow-alt-circle-down"})])}],!1,null,null,null).exports,D=s("ofXV"),k=s.n(D),U=s("BcCH"),P=s("PCDP"),G=s("i8R7"),E=s("nFxi");s("akQX");function $(t){return function(t){if(Array.isArray(t))return A(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return A(t,e);var s=Object.prototype.toString.call(t).slice(8,-1);"Object"===s&&t.constructor&&(s=t.constructor.name);if("Map"===s||"Set"===s)return Array.from(t);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return A(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(t,e){(null==e||e>t.length)&&(e=t.length);for(var s=0,o=new Array(e);s<e;s++)o[s]=t[s];return o}function L(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,o)}return s}function F(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?L(Object(s),!0).forEach((function(e){B(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):L(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function B(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var I={name:"ChatBox",components:{FileUploader:a.a,EmojiPicker:r.a,At:k.a,ChatBoxHeader:u,ChatBoxSettings:h,ChatBoxGroup:g,ChatRoomItem:y,ConversationHeader:M,MessageItem:j},props:{channel:{default:null},boxVisibility:{type:Boolean,default:!1},fullPage:{type:Boolean,default:!1},meeting:{type:Object,default:function(){return{}}}},data:function(){return{isBoxShown:!1,isSearchShown:!1,showChatOptions:!1,largeChatBox:!1,searched:!1,newChatScreen:!1,newGroupScreen:!1,cbHeaderTitle:$t("chat.live_chat"),searchTerm:"",searchTermEmoji:"",activeContainer:"home",members:[],newMessage:{message:"",attachments:[],updated:!1},newMessageRequestUUID:uuid(),activeConversation:null,activeGroup:null,activeGroupMembersToAdd:[],activeGroupMembersToRemove:[],uploadURL:"",formErrors:{},preRequisite:{uploaderConfig:{module:"",token:"",allowedExtensions:"",maxNoOfFiles:1,uuid:uuid()}},goingToConversation:!1,isFetching:!1,noMoreMessages:!1,newUnreadMessageOnFeed:!1,showScrollToLatestBtn:!1,chatRoomChannel:null,typingUser:null,typingUserTimeout:null,initialNewMessage:null,firstFetch:!0,fileIcons:E.b,fileMimeTypes:E.c}},watch:{boxVisibility:function(t,e){this.isBoxShown=t,this.isBoxShown&&document.body.classList.add("chat-box-shown")},activeChatUser:function(t,e){null===t||e&&(null===e||t.uuid===e.uuid)||this.goToConversation({user:t})},activeChatRoom:function(t,e){!1!==this.goingToConversation||null===t||e&&(null===e||t.uuid===e.uuid)||this.goToConversation({room:t})}},computed:F(F(F(F(F({},Object(o.c)("config",["vars","configs","uiConfigs"])),Object(o.c)("user",{userUuid:"uuid"})),Object(o.c)("user",["profile","username"])),Object(o.c)("chat",["rooms","roomsPageMeta","roomsSearch","messages","messagesPageMeta","messagesSearch","activeChatRoom","activeChatUser"])),{},{user:function(){return{uuid:this.userUuid,username:this.username,name:this.profile.name,profile:this.profile}},hasMessages:function(){return this.activeConversation&&this.messages.data},computedParticipants:function(){return this.activeConversation?this.activeConversation.members:[]},enterToSubmit:function(){return this.configs.chat&&this.configs.chat.enterToSubmit}}),methods:F(F({},Object(o.b)("chat",["GetRooms","GetRoom","AddMemberToRoom","RemoveMemberFromRoom","SearchRooms","SearchMessages","GetMessages","SendMessage","PutMessageToFeed","PatchMessageInFeed","ResetMessage","SetMessage","ResetTotalUnreadCount","SetActiveChatRoom","SetActiveChatUser","ResetActiveChatRoomAndUser","SearchRoomMembers"])),{},{hideChatBox:function(){var t=this;this.isBoxShown=!1,this.ResetActiveChatRoomAndUser(),setTimeout((function(){t.$emit("boxHidden")}),200)},showChatBox:function(){this.isBoxShown=!0,this.$emit("boxShown")},hideSearch:function(){this.searchTerm="",this.searched=!1,this.isSearchShown=!1,this.showChatOptions=!0,this.newChatScreen=!1,this.newGroupScreen=!1,"home"===this.activeContainer?(this.fetchRooms(!0),this.scrollTo("vue-scroll-rooms",0)):"conversation"===this.activeContainer&&this.fetchMessages(!0)},toggleSearch:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.searchTerm="",this.searched=!1,this.isSearchShown=!this.isSearchShown,this.isSearchShown?(this.newChatScreen=e,this.newGroupScreen=s,this.showChatOptions=!(e||s),this.$nextTick((function(){t.$refs.searchTerm.focus()}))):(this.newChatScreen=!1,this.newGroupScreen=!1,this.showChatOptions=!0,"home"===this.activeContainer?(this.fetchRooms(!0),this.scrollTo("vue-scroll-rooms",0)):"conversation"===this.activeContainer&&this.fetchMessages(!0))},startNewChat:function(){this.toggleSearch(!0)},goHome:function(){var t=this;this.lastActiveContainer=this.activeContainer,this.activeContainer="home",this.ResetActiveChatRoomAndUser(),"conversation"===this.lastActiveContainer?(this.leaveChatRoomChannel(this.activeConversation.chatRoom),this.hideSearch(),this.searchRoomObj&&this.searchRoomObj.searched?(this.searchTerm=this.searchRoomObj.searchTerm,this.searched=this.searchRoomObj.searched,this.isSearchShown=!0,this.showChatOptions=!1):this.fetchRooms()):this.fetchRooms(),this.scrollTo("vue-scroll-rooms",0),setTimeout((function(){t.activeConversation=null}),100)},goToConversation:function(t){var e=this,s=t.room,o=t.user;this.goingToConversation=!0;var a=function(){setTimeout((function(){e.activeContainer="conversation",e.isSearchShown?(e.searchRoomObj={searchTerm:e.searchTerm,searched:e.searched},e.hideSearch()):e.searchRoomObj={searchTerm:null,searched:null},e.goingToConversation=!1,window.setTimeout((function(){e.scrollToLatestMessages(),e.focusNewMessage(),e.showScrollToLatestBtn=!1,e.newUnreadMessageOnFeed=!1}),300)}),100)};this.activeConversation={chatRoom:s||null,user:s&&s.isGroup?null:o||null,members:s&&s.isGroup?s.members:o?[o]:[]},this.ResetMessage(),s?(s.hasLeft||this.joinChatRoomChannel(s),this.GetRoom({uuid:s.uuid}).then((function(t){var o=t.chatRoom,i=t.chats;e.activeConversation.chatRoom=o,s.hasLeft&&!o.hasLeft&&e.joinChatRoomChannel(o),o.hasLeft&&e.leaveChatRoomChannel(o),e.SetMessage({data:$(i),meta:F(F({},e.messages.meta),{},{total:i.length,lastItemUuid:i.length?i[i.length-1].uuid:null})}),e.activeConversation.chatRoom&&e.activeConversation.chatRoom.hasOwnProperty("chats")&&delete e.activeConversation.chatRoom.chats,e.noMoreMessages=!1,e.SetActiveChatRoom(e.activeConversation.chatRoom),a()})).catch((function(t){e.goingToConversation=!1,formUtil.handleErrors(t)}))):(this.SetActiveChatUser(this.activeConversation.user),this.fetchMessages(!0),a())},goToSettings:function(){var t=this;this.lastActiveContainer=this.activeContainer,this.activeContainer="settings",this.scrollTo("vue-scroll-rooms",0),setTimeout((function(){"conversation"===t.lastActiveContainer&&(t.ResetActiveChatRoomAndUser(),t.leaveChatRoomChannel(t.activeConversation.chatRoom)),t.isSearchShown&&t.hideSearch(),t.activeConversation=null}),100)},goToCreateGroup:function(){this.activeGroup=null,this.goToGroup()},goToGroup:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.activeGroupMembersToAdd=[],this.activeGroupMembersToRemove=[],this.lastActiveContainer=this.activeContainer,this.activeContainer="chatgroup",this.activeGroup=e,this.scrollTo("vue-scroll-rooms",0),this.isSearchShown&&this.hideSearch(),e||this.$nextTick((function(){window.setTimeout((function(){t.$refs.chatBoxGroup.$refs.groupName.focus()}),300)}))},showAddMemberScreen:function(){this.activeGroupMembersToAdd=[],this.activeGroupMembersToRemove=[],this.toggleSearch(!1,!0)},addToGroup:function(t){var e=this;t&&t.user&&(this.activeGroup?(this.isLoading=!0,this.AddMemberToRoom({uuid:this.activeGroup.uuid,members:[t.user]}).then((function(t){e.isLoading=!1,e.activeGroup=t,e.activeConversation.chatRoom=t,e.activeConversation.chatRoom.members=t.members})).catch((function(t){e.isLoading=!1,formUtil.handleErrors(t)}))):this.activeGroupMembersToAdd.push(t)),this.toggleSearch()},removeMemberFromGroup:function(t){var e=this;this.activeGroupMembersToAdd=[],this.activeGroupMembersToRemove=[],t&&t.user&&(this.activeGroup?(this.isLoading=!0,this.RemoveMemberFromRoom({uuid:this.activeGroup.uuid,members:[t.user]}).then((function(t){e.isLoading=!1,e.activeGroup=t,e.activeConversation.chatRoom=t})).catch((function(t){e.isLoading=!1,formUtil.handleErrors(t)}))):this.activeGroupMembersToRemove.push(t))},goBack:function(){this.lastActiveContainer?this.activeContainer=this.lastActiveContainer:this.goHome()},searchTermChanged:_.debounce((function(){!this.searchTerm||this.searchTerm.length<2||("home"===this.activeContainer||"chatgroup"===this.activeContainer?(this.searchRooms(),this.scrollTo("vue-scroll-rooms",0)):"conversation"===this.activeContainer&&this.searchMessages())}),500),handleAt:function(t){var e=this;!t||t.length<2?this.activeConversation&&(this.activeConversation.members=[]):this.activeConversation.chatRoom?this.SearchRoomMembers({uuid:this.activeConversation.chatRoom.uuid,term:t}).then((function(t){e.activeConversation.members=t})).catch((function(t){formUtil.handleErrors(t),e.activeConversation&&(e.activeConversation.members=[])})):this.activeConversation.members=[]},fetchRooms:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isFetching=!0;var s=F(F({},this.roomsPageMeta),{},{lastItemUuid:e?null:this.rooms.meta.lastItemUuid,perPage:this.rooms.meta.perPage});this.GetRooms(s).then((function(e){t.isFetching=!1})).catch((function(e){t.isFetching=!1,formUtil.handleErrors(e)}))},searchRooms:function(){var t=this;this.isFetching=!0,this.SearchRooms(this.searchTerm).then((function(e){t.searched=!0,t.showChatOptions=!1,t.isFetching=!1})).catch((function(e){t.isFetching=!1,formUtil.handleErrors(e)}))},searchMessages:function(){var t=this;this.activeConversation.chatRoom&&(this.isFetching=!0,this.SearchMessages({q:this.searchTerm,chatRoom:this.activeConversation.chatRoom.uuid}).then((function(e){t.searched=!0,t.isFetching=!1,window.setTimeout((function(){t.scrollToLatestMessages(),t.showScrollToLatestBtn=!1,t.newUnreadMessageOnFeed=!1}),300)})).catch((function(e){t.isFetching=!1,formUtil.handleErrors(e)})))},fetchMessages:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.activeConversation.chatRoom||this.activeConversation.user){this.isFetching=!0,this.noMoreMessages=!1,this.newUnreadMessageOnFeed=!1;var s=F(F({},this.messagesPageMeta),{},{lastItemUuid:e?null:this.messages.meta.lastItemUuid,perPage:this.messages.meta.perPage,chatRoom:this.activeConversation.chatRoom?this.activeConversation.chatRoom.uuid:null,user:this.activeConversation.user?this.activeConversation.user.uuid:null});this.GetMessages(s).then((function(s){t.isFetching=!1,s.data.length||(t.noMoreMessages=!0),e&&window.setTimeout((function(){t.scrollToLatestMessages(),t.showScrollToLatestBtn=!1,t.newUnreadMessageOnFeed=!1}),300),t.searched||t.focusNewMessage()})).catch((function(e){t.isFetching=!1,formUtil.handleErrors(e)}))}},chatRoomUpdated:function(){var t=this;this.GetRoom({uuid:this.activeConversation.chatRoom.uuid}).then((function(e){var s=e.chatRoom;t.activeConversation.chatRoom=s,e.hasLeft&&t.leaveChatRoomChannel(s)})).catch((function(t){formUtil.handleErrors(t)}))},postMessage:function(){var t=this;if(this.newMessage.message){this.newMessage.message=this.newMessage.message.trim();var e={uuid:this.newMessageRequestUUID,message:this.newMessage.message,user:this.user,sentAt:moment().format(this.vars.serverDateTimeFormat),status:"sending"};this.newMessageRequestUUID=uuid(),this.newMessage=_.cloneDeep(this.initialNewMessage),this.noMoreMessages=!1,this.putMessageToFeed(e),window.setTimeout((function(){t.scrollTo("vue-scroll-messages",100),t.focusNewMessage()}),300),this.SendMessage({message:e.message,chatRoom:this.activeConversation.chatRoom,user:this.activeConversation.user}).then((function(s){t.messageSentSuccess(e,s)})).catch((function(s){t.messageSendingFailed(e,s)}))}},attachmentUploadStarted:function(t){var e=this;if(this.newMessage.attachments&&!this.newMessage.attachments.length){var s={uuid:this.newMessageRequestUUID,message:null,user:this.user,sentAt:moment().format(this.vars.serverDateTimeFormat),status:"sending"};this.newMessageRequestUUID=uuid(),this.newMessage=_.cloneDeep(this.initialNewMessage),this.putMessageToFeed(s),window.setTimeout((function(){e.scrollTo("vue-scroll-messages",100),e.focusNewMessage()}),300)}},attachmentUploaded:function(t){U.a.$emit("RESET_UPLOAD"),this.messageSentSuccess({uuid:t.meta.requestUuid},t)},attachmentUploadError:function(t){U.a.$emit("RESET_UPLOAD"),t&&this.messageSendingFailed({uuid:response.meta.requestUuid},t)},messageSentSuccess:function(t,e){var s=this,o=e.data;this.PatchMessageInFeed({old:t,new:F(F({},o),{},{newUuid:o.uuid,uuid:t.uuid})}),this.activeConversation.chatRoom||(this.joinChatRoomChannel(o.chatRoom),this.GetRoom({uuid:o.chatRoom.uuid}).then((function(t){s.activeConversation.chatRoom=t.chatRoom,s.activeConversation.chatRoom&&s.activeConversation.chatRoom.hasOwnProperty("chats")&&delete s.activeConversation.chatRoom.chats})).catch((function(t){formUtil.handleErrors(t)})))},messageSendingFailed:function(t,e){this.PatchMessageInFeed({old:t,new:F(F({},t),{},{status:"error",error:formUtil.getError(e)})})},noNeedCallback:function(){this.afterUploadComplete()},joinChatRoomChannel:function(t){window.EchoOpts.subscriptions.chatRoom=window.Echo.join("ChatRoom.".concat(t.uuid)),this.chatRoomChannel=window.EchoOpts.subscriptions.chatRoom,this.chatRoomChannel.listen("ChatMessageSentToRoom",this.newMessageReceived),this.chatRoomChannel.listen("ChatRoomUpdated",this.chatRoomUpdated),this.chatRoomChannel.listenForWhisper("typing",this.anotherUserTyping)},leaveChatRoomChannel:function(t){this.chatRoomChannel&&(this.chatRoomChannel.stopListening("ChatMessageSentToRoom"),this.chatRoomChannel=null),t&&window.Echo.leave("ChatRoom.".concat(t.uuid)),window.EchoOpts&&window.EchoOpts.subscriptions&&(window.EchoOpts.subscriptions.chatRoom=null)},enterPressedEvt:function(t,e){return!!this.enterToSubmit&&Object(P.enterPressed)(t,e)},putMessageToFeed:function(t){-1===this.messages.data.findIndex((function(e){return e.uuid===t.uuid}))&&this.PutMessageToFeed(t)},focusNewMessage:function(){this.$refs.newMessageInput&&this.$refs.newMessageInput.focus()},scrollTo:function(t,e){this.$refs[t]&&this.$refs[t].scrollTo({y:"".concat(e,"%")},300)},scrollToLatestMessages:function(){this.scrollTo("vue-scroll-messages",100)},handleMessageScroll:_.debounce((function(t,e){t.process>.95?(this.showScrollToLatestBtn=!1,this.newUnreadMessageOnFeed=!1):(!this.searched||this.searched&&0!==t.process)&&(this.showScrollToLatestBtn=!0),t.process<.5&&!this.isFetching&&!this.noMoreMessages&&this.fetchMessages()}),500),handleRoomsScroll:_.debounce((function(t,e){t.process>.5&&!this.isFetching&&this.fetchRooms()}),500),isTyping:_.throttle((function(){this.chatRoomChannel&&this.chatRoomChannel.whisper("typing",{user:this.user})}),500,{leading:!0,trailing:!1}),anotherUserTyping:function(t){var e=this,s=t.user;this.typingUser=s.name,this.typingUserTimeout&&clearTimeout(this.typingUserTimeout),this.typingUserTimeout=setTimeout((function(){e.typingUser=null}),1500)},newMessageReceived:function(t){var e=this;t&&(t=Object(G.b)(t))&&t.user&&t.user.uuid!==this.userUuid&&(this.putMessageToFeed(t),window.setTimeout((function(){var t=e.$refs["vue-scroll-messages"].getScrollProcess(),s=t.v;t.h;s>.5?e.scrollToLatestMessages():(e.showScrollToLatestBtn=!0,e.newUnreadMessageOnFeed=!0)}),300))},appendEmoji:function(t){this.newMessage.message+=t},doInit:function(){var t=this;this.initialNewMessage=_.cloneDeep(this.newMessage),this.activeChatRoom?this.goToConversation({room:this.activeChatRoom}):this.activeChatUser?this.goToConversation({user:this.activeChatUser}):this.fetchRooms(),this.isBoxShown&&document.body.classList.add("chat-box-shown"),setTimeout((function(){t.showChatOptions=t.boxVisibility}),1e3)}}),directives:{focus:{inserted:function(t){t.focus()}}},mounted:function(){var t=this;setTimeout((function(){t.isBoxShown=t.boxVisibility}),100),setTimeout((function(){t.doInit()}),200)},created:function(){},beforeDestroy:function(){document.body.classList.remove("chat-box-shown"),window.Echo&&window.EchoOpts&&window.EchoOpts.subscriptions&&window.EchoOpts.subscriptions.chatRoom&&(window.EchoOpts.subscriptions.chatRoom.stopListening("ChatMessageSentToRoom"),window.EchoOpts.subscriptions.chatRoom=null)}},N=Object(c.a)(I,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{class:["chat-box-wrapper",{shown:t.isBoxShown},{"search-shown":t.isSearchShown},{"chat-box-lg":t.largeChatBox},{"show-chat-options":t.showChatOptions}]},[s("chat-box-header",{attrs:{"active-container":t.activeContainer,configs:t.configs,"full-page":t.fullPage},on:{goHome:t.goHome,toggleSearch:t.toggleSearch,goToSettings:t.goToSettings,goBack:t.goBack,hideChatBox:t.hideChatBox,showAddMemberScreen:t.showAddMemberScreen}}),t._v(" "),s("div",{staticClass:"search"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.searchTerm,expression:"searchTerm"}],ref:"searchTerm",staticClass:"form-control",attrs:{type:"text",placeholder:t.$t("general.search_helper_default_text")},domProps:{value:t.searchTerm},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:t.toggleSearch(e)},input:[function(e){e.target.composing||(t.searchTerm=e.target.value)},t.searchTermChanged]}}),t._v(" "),t.searchTerm?s("button",{staticClass:"clear-btn",attrs:{type:"button"},on:{click:t.hideSearch}},[t._v(t._s(t.$t("general.clear")))]):t._e()]),t._v(" "),s("div",{class:["chat-box",{"showing-settings":"settings"===t.activeContainer},{"showing-chats":"conversation"===t.activeContainer},{"showing-chatgroup":"chatgroup"===t.activeContainer}]},[t.configs.chat.groupChat?s("chat-box-group",{ref:"chatBoxGroup",attrs:{"active-container":t.activeContainer,"active-group":t.activeGroup,"members-to-add":t.activeGroupMembersToAdd,"members-to-remove":t.activeGroupMembersToRemove},on:{goToConversation:t.goToConversation,goBack:t.goBack,goHome:t.goHome},scopedSlots:t._u([{key:"members",fn:function(e){var o=e.members;return[s("div",{staticClass:"rooms-wrapper"},[t.searchTerm&&t.searched?[t.roomsSearch.rooms.length||t.roomsSearch.users.length?s("ul",{staticClass:"rooms"},[t._l(t.roomsSearch.rooms,(function(e){return[e.isGroup?t._e():s("chat-room-item",{key:e.uuid,attrs:{room:e,"room-name":e.name,"click-action":"addToGroup",vars:t.vars,"show-last-message":!1},on:{addToGroup:t.addToGroup}})]})),t._v(" "),t._l(t.roomsSearch.users,(function(e){return s("chat-room-item",{key:e.uuid,attrs:{room:e,"room-name":e.profile.name,"click-action":"addToGroup",vars:t.vars},on:{addToGroup:t.addToGroup}})}))],2):s("div",{staticClass:"no-data"},[s("h5",[t._v(t._s(t.$t("chat.no_result_found")))])])]:[s("ul",{staticClass:"rooms"},t._l(o,(function(e){return s("chat-room-item",{key:e.user.uuid,attrs:{room:e.user,"room-name":e.user.profile.name,"click-action":"goToConversation","show-custom-action":t.activeGroup&&t.activeGroup.canModerate,"click-action-on-custom":"removeMember",vars:t.vars},on:{goToConversation:t.goToConversation,removeMember:t.removeMemberFromGroup}})})),1)]],2)]}}],null,!1,3003752676)}):t._e(),t._v(" "),s("chat-box-settings",{attrs:{"active-container":t.activeContainer},on:{goHome:t.goHome}}),t._v(" "),s("div",{staticClass:"cb-inner-window rooms-container"},[s("vue-scroll",{ref:"vue-scroll-rooms",attrs:{id:"vue-scroll-rooms"},on:{"handle-scroll":t.handleRoomsScroll}},[s("div",{staticClass:"rooms-wrapper"},[t.searchTerm&&t.searched||t.newChatScreen||t.newGroupScreen?[t.roomsSearch.rooms.length||t.roomsSearch.users.length?s("ul",{staticClass:"rooms"},[t.newChatScreen&&t.newGroupScreen?t._e():[t._l(t.roomsSearch.rooms,(function(e){return s("chat-room-item",{key:e.uuid,attrs:{room:e,"room-name":e.name,vars:t.vars},on:{goToConversation:t.goToConversation}})})),t._v(" "),t.roomsSearch.users.length?s("li",{staticClass:"my-2 pl-3 font-weight-500"},[t._v(t._s(t.$t("user.users")))]):t._e()],t._v(" "),t._l(t.roomsSearch.users,(function(e){return s("chat-room-item",{key:e.uuid,attrs:{room:e,"room-name":e.profile.name,"click-action":"goToConversation",vars:t.vars},on:{goToConversation:t.goToConversation}})}))],2):s("div",{staticClass:"no-data"},[s("h5",[t._v(t._s(t.$t("chat.no_result_found")))])])]:[t.rooms.data&&t.rooms.data.length?s("ul",{staticClass:"rooms"},t._l(t.rooms.data,(function(e){return s("chat-room-item",{key:e.uuid,attrs:{room:e,"room-name":e.name,vars:t.vars},on:{goToConversation:t.goToConversation}})})),1):s("div",{staticClass:"no-data"},[s("h5",[t._v(t._s(t.$t("chat.no_chats_yet")))])])]],2)]),t._v(" "),s("div",{staticClass:"chat-option-buttons"},[t.configs.chat.groupChat?s("button",{attrs:{type:"button"},on:{click:t.goToCreateGroup}},[s("i",{staticClass:"fas fa-users"})]):t._e(),t._v(" "),s("button",{attrs:{type:"button"},on:{click:t.startNewChat}},[s("i",{staticClass:"fas fa-user"})]),t._v(" "),t._m(0)])],1),t._v(" "),s("div",{staticClass:"cb-inner-window conversation-container"},[t.activeConversation?s("div",{staticClass:"conversation-wrapper"},[t.activeConversation.chatRoom?s("conversation-header",{attrs:{room:t.activeConversation.chatRoom,"room-name":t.activeConversation.chatRoom.name,vars:t.vars,configs:t.configs,typingUser:t.typingUser},on:{goToGroup:t.goToGroup}}):t.activeConversation.user?s("conversation-header",{attrs:{room:t.activeConversation.user,"room-name":t.activeConversation.user.profile.name,vars:t.vars,typingUser:t.typingUser}}):t._e(),t._v(" "),s("div",{class:["conversation",{"no-messages":!t.hasMessages},{"got-new-messages":t.newUnreadMessageOnFeed},{"show-scroll-btn":t.showScrollToLatestBtn}]},[t.hasMessages?s("div",{staticClass:"messages-list-container"},[s("vue-scroll",{ref:"vue-scroll-messages",attrs:{id:"vue-scroll-messages"},on:{"handle-scroll":t.handleMessageScroll}},[s("div",{class:["messages-list-wrapper",{"show-name":t.activeConversation.chatRoom&&t.activeConversation.chatRoom.isGroup}]},[t.searchTerm&&t.searched?[t.messagesSearch.length?t._l(t.messagesSearch,(function(e,o){return s("message-item",{key:e.uuid,class:[{"own-message":e.user.uuid===t.userUuid},{"prev-diff-own":!t.messages.data[o+1]||t.messages.data[o+1].user.uuid!==e.user.uuid},{"next-diff-own":!t.messages.data[o-1]||t.messages.data[o-1].user.uuid!==e.user.uuid}],attrs:{message:e,vars:t.vars,"file-icons":t.fileIcons,"file-mime-types":t.fileMimeTypes}})})):s("div",{staticClass:"no-data"},[s("h5",[t._v(t._s(t.$t("chat.no_result_found")))])])]:[t._l(t.messages.data,(function(e,o){return s("message-item",{key:e.uuid,class:[{"own-message":e.user.uuid===t.userUuid},{"prev-diff-own":!t.messages.data[o+1]||t.messages.data[o+1].user.uuid!==e.user.uuid},{"next-diff-own":!t.messages.data[o-1]||t.messages.data[o-1].user.uuid!==e.user.uuid}],attrs:{message:e,vars:t.vars,"file-icons":t.fileIcons,"file-mime-types":t.fileMimeTypes}})})),t._v(" "),t.isFetching?s("div",{staticClass:"d-flex justify-content-center my-2"},[s("animated-loader",{attrs:{"is-loading":t.isFetching,"loader-color":t.vars.colors.light,"overlay-color":"transparent",size:"inline","loader-size":"20px","loader-stroke":"3px"}})],1):t._e(),t._v(" "),t.noMoreMessages?s("div",{staticClass:"message-item my-4 d-flex justify-content-center align-items-center"},[s("h5",{staticClass:"text-muted"},[t._v("\n                                            "+t._s(t.$t("chat.no_more_messages"))+"\n                                        ")])]):t._e()]],2)])],1):s("div",{staticClass:"d-flex justify-content-center align-items-center min-height-300px"},[s("h5",{staticClass:"text-muted"},[t._v("\n                            "+t._s(t.$t("chat.no_messages_yet"))+"\n                        ")])]),t._v(" "),s("div",{staticClass:"scroll-latest-btn",on:{click:t.scrollToLatestMessages}},[t._m(1)])]),t._v(" "),t.activeConversation.chatRoom&&!t.activeConversation.chatRoom.isGroup||!t.activeConversation.chatRoom&&t.activeConversation.user||t.activeConversation.chatRoom&&t.activeConversation.chatRoom.isGroup&&!t.activeConversation.chatRoom.hasLeft?s("div",{staticClass:"conversation-footer"},[s("div",{staticClass:"new-message"},[s("at",{attrs:{members:t.computedParticipants,"name-key":"name"},on:{at:t.handleAt},scopedSlots:t._u([{key:"item",fn:function(e){return[s("span",{staticClass:"mentioned"},[t._v(t._s(e.item.name)+" "),s("span",{staticClass:"bracketed text-muted-md"},[t._v(t._s(e.item.username))])])]}},{key:"embeddedItem",fn:function(e){return[s("span",[s("span",{staticClass:"tag mentioned bg-white text-primary mx-1 px-2 py-1 rounded",attrs:{"data-uuid":e.current&&e.current.user?e.current.user.uuid:""}},[t._v(t._s(e.current.name))]),t._v(" "),s("span")])]}}],null,!1,1168386567),model:{value:t.newMessage.message,callback:function(e){t.$set(t.newMessage,"message",e)},expression:"newMessage.message"}},[t._v(" "),t._v(" "),s("div",{ref:"newMessageInput",staticClass:"new-message-input form-control",attrs:{contenteditable:"","data-placeholder":t.$t("chat.type_a_message"),placeholder:t.$t("chat.type_a_message")},on:{keydown:[t.isTyping,function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.enterPressedEvt(t.postMessage,e)}]}})]),t._v(" "),s("emoji-picker",{staticClass:"emoji-picker-wrapper",attrs:{search:t.searchTermEmoji},on:{emoji:t.appendEmoji},scopedSlots:t._u([{key:"emoji-invoker",fn:function(t){var e=t.events.click;return s("button",{staticClass:"btn-custom emoji-button",attrs:{type:"button"},on:{click:function(t){return t.stopPropagation(),e(t)}}},[s("i",{staticClass:"far fa-grin"})])}},{key:"emoji-picker",fn:function(e){var o=e.emojis,a=e.insert;e.display;return s("div",{staticClass:"emoji-picker-container"},[s("div",{staticClass:"emoji-picker"},[s("div",{staticClass:"emoji-picker__search"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.searchTermEmoji,expression:"searchTermEmoji"},{name:"focus",rawName:"v-focus"}],attrs:{type:"text"},domProps:{value:t.searchTermEmoji},on:{input:function(e){e.target.composing||(t.searchTermEmoji=e.target.value)}}})]),t._v(" "),s("div",t._l(o,(function(e,o){return s("div",{key:o,staticClass:"mt-2"},[s("h5",[t._v(t._s(o))]),t._v(" "),s("div",{staticClass:"emojis"},t._l(e,(function(e,o){return s("span",{key:o,attrs:{title:o},on:{click:function(t){return a(e)}}},[t._v(t._s(e))])})),0)])})),0)])])}}],null,!1,1197881671)}),t._v(" "),!t.newMessage.message&&t.configs.chat.fileSharing?s("file-uploader",{attrs:{url:"/chat/messages","name-label":"upload.attachment","names-label":"upload.attachments","button-icon":"fas fa-paperclip","button-classes":"btn-sm","button-design":"custom","hide-button-label":"","hide-file-list":"",options:t.preRequisite.uploaderConfig,data:t.newMessage.attachments,"additional-form-data":t.activeConversation,"request-identifier":t.newMessageRequestUUID},on:{uploading:t.attachmentUploadStarted,updated:t.attachmentUploaded,error:t.attachmentUploadError,noNeed:t.noNeedCallback}}):t._e(),t._v(" "),s("button",{staticClass:"btn-custom post-message-button",attrs:{type:"button",title:t.$t("general.submit")},on:{click:t.postMessage}},[s("i",{staticClass:"far fa-paper-plane"})])],1)]):t._e()],1):t._e()])],1)],1)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("button",{attrs:{type:"button"}},[e("i",{staticClass:"fas fa-comment-dots fa-flip-horizontal"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"scroll-btn-wrapper"},[e("i",{staticClass:"fas fa-angle-double-down"})])}],!1,null,null,null);e.a=N.exports},PLx1:function(t,e,s){(t.exports=s("I1BE")(!1)).push([t.i,".settings-wrapper{flex-direction:column}.settings-wrapper,.settings-wrapper .settings{display:flex;height:100%;max-height:100%;overflow:hidden}.settings-wrapper .settings{flex-grow:1;justify-content:stretch;align-items:stretch;position:relative;padding:.85rem;flex-direction:row}.settings-wrapper .settings .switch-wrapper>.input-group-material-label{padding-left:0}.settings-wrapper .settings-footer{box-shadow:0 -2px 6px 0 rgba(0,0,0,.4);z-index:1}",""])},aWil:function(t,e,s){"use strict";s("nibG")},akQX:function(t,e,s){"use strict";s.d(e,"d",(function(){return a})),s.d(e,"b",(function(){return r})),s.d(e,"a",(function(){return n})),s.d(e,"c",(function(){return c}));var o=s("V0LQ");navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||alert($t("misc.get_user_media_not_supported")),navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices&&(navigator.enumerateDevices=function(t){navigator.mediaDevices.enumerateDevices().then(t)});location.protocol;"undefined"!=typeof MediaStreamTrack&&"getSources"in MediaStreamTrack||navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices;var a=function(t){var e={icon:"error",footer:$t("misc.solve_and_refresh")};if(t)return"NotAllowedError"===t.name||"PermissionDeniedError"===t.name?(e.title=$t("misc.media.permission_denied"),e.text=$t("misc.media.permission_denied_text")):"NotFoundError"===t.name?(e.title=$t("misc.media.not_found"),e.text=$t("misc.media.not_found_text")):"NotReadableError"===t.name||"OverconstrainedError"===t.name?(e.title=$t("misc.media.unreadable"),e.text=$t("misc.media.unreadable_text")):"SecurityError"!==t.name&&"TypeError"!==t.name||(e.title=$t("misc.media.security"),e.text=$t("misc.media.security_text")),{msg:e,alert:swtAlert.fire(e)}},i=function(t){if((t=Object.assign({},{type:null,loop:!1,duration:1e3},t)).type){var e=new Audio;return e.preload="auto",e.autoplay=!0,e.loop=t.loop,e.src="/sound/".concat(t.type,".mp3"),e.play().then((function(){setTimeout((function(){e&&e.pause()}),t.duration)})).catch((function(t){console.error(t)})),e}},r=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!document.hasFocus()||t)return i({type:"calling",loop:!0,duration:3e4})},n=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!document.hasFocus()||t)return i({type:"message",duration:3e3})},c=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0,s=document.querySelector("link[rel=canonical]")?document.querySelector("link[rel=canonical]").href:document.location.href,a=t.url?t.url:s;if(navigator.share)navigator.share({title:t.title?t.title:document.title,url:a}).then((function(){console.log("Thanks for sharing!")})).catch(console.error);else{var i={showCancelButton:!0,confirmButtonText:$t("misc.share_alert.confirm_btn"),cancelButtonText:$t("misc.share_alert.cancel_btn")};t.alertTitle&&(i.title=t.alertTitle),t.alertHtml?i.html=t.alertHtml:i.text=$t("misc.share_alert.text"),swtAlert.fire(i).then((function(t){t.value&&(Object(o.c)(a),setTimeout((function(){e()}),500))}))}}},nibG:function(t,e,s){var o=s("8Cr2");"string"==typeof o&&(o=[[t.i,o,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};s("aET+")(o,a);o.locals&&(t.exports=o.locals)},yufk:function(t,e,s){var o=s("PLx1");"string"==typeof o&&(o=[[t.i,o,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};s("aET+")(o,a);o.locals&&(t.exports=o.locals)}}]);
//# sourceMappingURL=app-layout.js.map?id=44142543568e23776c96